---
title: "HW13"
author: '113078506'
date: "2025-05-17"
output:
  pdf_document:
    keep_tex: true
    latex_engine: xelatex
    number_sections: true
    toc: true
always_allow_html: true
---

- Gen AI Usage: I use Gen AI to refine my grammar, verify my reasoning and adjust to cleaner code.
- Students who helped: 113078505, 113078502, and 113078514, helped with conclusion reasoning.

## Question 1) Composite Path Models using PLS-PM

```{r}
library(seminr)
sec = read.csv("security_data_sem.csv")
```

### a. Create a PLS path model using SEMinR, with all the following characteristics:
### i. Measurement model – all constructs are measured as composites:
### 1. Trust in website (TRUST): items TRST1 - TRST4 
### 2. Perceived security of website (SEC): items PSEC1 - PSEC4
### 3. Reputation of website (REP): items PREP1 - PREP4
### 4. Investment in website (INV): items PINV1 - PINV3
### 5.Perception of privacy policies (POL): items PPSS1 - PPSS3
### 6. Familiarity with website (FAML): item FAML1
(see the documentation of SEMinR for making single item constructs)
### 7. Interaction between REP and POL (use orthogonalized product terms)

```{r}
sec_mm <- constructs(
composite("TRUST", multi_items("TRST", 1:4)),
composite("SEC", multi_items("PSEC", 1:4)),
composite("REP", multi_items("PREP", 1:4)),
composite("INV", multi_items("PINV", 1:3)),
composite("POL", multi_items("PPSS", 1:3)),
composite("FAML", single_item("FAML1")),
interaction_term(iv="REP", moderator="POL", method=orthogonal)
)
```

### ii. Structural Model – paths between constructs as shown in this causal model:
REP + INV + POL + FAML + (REP✕POL) → SEC → TRUST

```{r}
sec_sm <- relationships(
paths(from = c("REP", "INV", "POL", "FAML", "REP*POL"), to = "SEC"),
paths(from = "SEC", to = "TRUST")
)
```

### b. Show us the following results in table or figure formats:
### i. Plot a figure of the estimated model

```{r}
sec_pls <- estimate_pls(data = sec,
measurement_model = sec_mm,
structural_model = sec_sm)

plot(sec_pls)
```

### ii. Weights and loadings of composites

```{r}
summary(sec_pls)$weights
```

```{r}
summary(sec_pls)$loadings
```

### iii. Regression coefficients of paths between factors

```{r}
summary(sec_pls)$paths
```

### iv. Bootstrapped path coefficients: t-values, 95% CI

```{r}
set.seed(1234)
boot_pls <- bootstrap_model(sec_pls, nboot = 1000)

boot_paths <- summary(boot_pls)$bootstrapped_paths
boot_paths
```

```{r}
library(knitr)
kable(boot_paths[, c("T Stat.", "2.5% CI", "97.5% CI")])
```

## Question 2) Common-Factor Models using CB-SEM
### a. Create a common factor model using SEMinR, with the following characteristics:
### i. Either respecify all the constructs as being reflective(), or use the as.reflective() function to convert your earlier measurement model to being entirely reflective.
### ii. Use the same structural model as before (you can just reuse it again!)

```{r}
sec_cf_mm <- as.reflective(sec_mm)

sec_cf_pls <- estimate_cbsem(
data = sec,
measurement_model = sec_cf_mm,
structural_model = sec_sm
)
```

### b. Show us the following results in table or figure formats
### i. Plot a figure of the estimated model (it will look different from your PLS model!)

```{r}
plot(sec_cf_pls)
```

### ii. Loadings of composites

```{r}
summary(sec_cf_pls)$loadings
```

### iii. Regression coefficients of paths between factors, and their p-values

```{r}
# Regression coefficients
summary(sec_cf_pls)$paths$coefficients
```


```{r}
# P-values
summary(sec_cf_pls)$paths$pvalues
```

